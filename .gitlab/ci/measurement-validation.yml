validate_measurements:
  extends: .basic
  stage: validate 
  rules:
    # Triggered on merge requests
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
      when: on_success 

    # Also triggered on direct pushes
    - if: $CI_PIPELINE_SOURCE == "push"
      when: on_success

    # Do not trigger otherwise
    - when: never

  script:
    - for measurement in $( ls measurements ); do python3 top-comb.py --tag validation setup -m $measurement; done
  
  artifacts:
    paths:
      - workdirs/validation/
    when: always
    expire_in: 1 week
